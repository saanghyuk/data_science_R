ggplot(aes(x = reorder(class, -n), y=n)) +
geom_bar(stat = 'identity')
# Line Graph
ggplot(data=economics, aes(x=date, y=unemploy)) + geom_line()
ggplot(data=economics, aes(x=date, y=psavert)) + geom_line()
# Box Plot
ggplot(data=mpg, aes(x=drv, y=hwy)) + geom_boxplot()
ggplot(data=mpg, aes(x=class, y=cty)) + geom_boxplot()
# Quiz
mpg_com <- mpg %>%
filter(class %in%  c("compact", "subcompact", "suv"))
ggplot(data=mpg_com, aes(x=class, y=cty)) + geom_boxplot()
# Find missing values
df <- data.frame(sex=c("M", "F", NA, "M", "F"),
score=c(5, 4, 3, 4, NA))
df
is.na(df)
table(is.na(df))
table(is.na(df$score))
table(is.na(df$sex))
mean(df$sex)
mean(df$score)
library(dplyr)
df %>% filter(is.na(score))
df %>% filter(!is.na(score))
df_nomiss <-df %>% filter(!is.na(score))
sum(df_nomiss$score)
df_nomiss <-df %>% filter(!is.na(score) & !is.na(sex))
df_nomiss <-df %>% filter(!is.na(score) & !is.na(sex))
df_nomiss
df %>% filter(!is.na(df))
df %>% filter(!is.na(df))
df_nomiss2 <- na.omit(df)
df_nomiss2
mean(df$sex, na.rm=T)
#
mean(df$score, na.rm=T)
mean(df$sex, na.rm=T)
#
mean(df$score, na.rm=T)
mean(df$sex, na.rm=T)
exam[c(3, 8, 15), "math"] <- NA
exam <- read.csv("source/Data/csv_exam.csv", header=TRUE)
exam[c(3, 8, 15), "math"] <- NA
exam %>%
summarise(mean_math = mean(math))
exam %>%
summarise(mean_math = mean(math), na.rm=T)
exam %>%
summarise(mean_math = mean(math, na.rm=T))
# 결측치 대체하기
mean(exam$math, na.rm=T)
exam$math <- ifelse(is.na(exam$math), 55, exam$math)
exam
mpg[c(65, 124, 131, 153, 212), "hwy"]
mpg[c(65, 124, 131, 153, 212), "hwy"] <- NA
# 1
table(is.na(mpg$drv))
table(is.na(mpg$hwy))
#
mpg %>% filter(!is.na(mpg$hwy)) %>%
group_by(class) %>%
summarise(mean_hwy = mean())
#
mpg %>% filter(!is.na(mpg$hwy)) %>%
group_by(class) %>%
summarise(mean_hwy = mean(hwy))
#
mpg %>% filter(!is.na(mpg$hwy)) %>%
group_by(class) %>%
summarise(mean_hwy = mean(hwy)) %>%
arrange(desc(hwy))
#
mpg %>% filter(!is.na(mpg$hwy)) %>%
group_by(class) %>%
summarise(mean_hwy = mean(hwy)) %>%
arrange(desc(mean_hwy))
# Outlier
# 논리적으로 존재할 수 없는 경우
outlier <- data.frame(sex=c(1, 2, 1, 3, 2, 1),
score=c(5, 4, 3, 4, 2, 6))
outlier
ifelse(sex %in% c(1, 2), TRUE, FALSE)
ifelse(outlier$sex %in% c(1, 2), TRUE, FALSE)
ggplot(data=outlier, aes(x=sex)) + geom_bar()
ggplot(data=outlier, aes(x=score)) + geom_bar()
ggplot(data=outlier, aes(x=sex)) + geom_bar()
# 이상치 체크
table(outlier$sex)
table(outlier$score)
outlier$sex <- ifelse(outlier$sex ==3, NA, outlier$sex)
outlier$sex <- ifelse(outlier$score ==5, NA, outlier$score)
# Outlier
# 논리적으로 존재할 수 없는 경우
outlier <- data.frame(sex=c(1, 2, 1, 3, 2, 1),
score=c(5, 4, 3, 4, 2, 6))
outlier$sex <- ifelse(outlier$sex ==3, NA, outlier$sex)
outlier$score <- ifelse(outlier$score => 5, NA, outlier$score)
outlier$score <- ifelse(outlier$score > 5, NA, outlier$score)
# 이상치 체크
table(outlier$sex) # 1 or 2
table(outlier$score) # 1 ~ 5
is.na(outlier)
table(is.na(ouutlier$sex))
table(is.na(ouutlier$score))
table(is.na(outlier$score))
table(is.na(outlier$sex))
oulier %>%
filter(!is.na(sex) & !is.na(score))
outlier %>%
filter(!is.na(outlier$sex) & !is.na(outlier$score))
group_by(sex) %>%
summarise(mean_score = mean(score))
outlier %>%
filter(!is.na(outlier$sex) & !is.na(outlier$score)) %>%
group_by(sex) %>%
summarise(mean_score = mean(score))
# 극단적인 값.
mpg <- as.data.frame(ggplot2::mpg)
boxplot(mpg$why)
boxplot(mpg$hwy)
boxplot(mpg$hwy)$stats
boxplot(mpg$hwy)$stats[3]
ifelse(boxplot$hwy < 12 | boxplot$hwy >37, NA, boxplot$hwy)
ifelse(boxplot$hwy < 12 || boxplot$hwy >37, NA, boxplot$hwy)
ifelse(boxplot$hwy < 12 | boxplot$hwy >37, NA, boxplot$hwy)
ifelse(mpg$hwy < 12 | mpg$hwy >37, NA, mpg$hwy)
mpg$why <-  ifelse(mpg$hwy < 12 | mpg$hwy >37, NA, mpg$hwy)
table(is.na(mpg$hwy))
mpg$hwy<-  ifelse(mpg$hwy < 12 | mpg$hwy >37, NA, mpg$hwy)
table(is.na(mpg$hwy))
mpg %>%
group_by(drv) %>%
summarise(mean_hwy = mean(hwy, na.rm = T))
# Q
mpg <- as.data.frame(ggplot2::mpg)
mpg[c(29, 43, 129, 203), "cty"] <- c(3, 4, 39, 42)
mpg[c(10, 14, 58, 93), "drv"] <- "k"
mpg[c(29, 43, 129, 203), "cty"] <- c(3, 4, 39, 42)
table(mpg$driv)
table(mpg$drv)
ifelse(mpg$drv %notin% c("4", "f", "k"), NA, mpg$drv)
ifelse(mpg$drv %in% c("4", "f", "k"), mpg$drv, NA)
mpg$drv <- ifelse(mpg$drv %in% c("4", "f", "k"), mpg$drv, NA)
boxplot(mpg$cty)
boxplot(mpg$cty)$stats
ifelse(mpg$cty < 9 | mpg$cty > 26, NA,  mpg$cty)
mpg$cty <-  ifelse(mpg$cty < 9 | mpg$cty > 26, NA,  mpg$cty)
boxplot(mpg$cty)
mpg %>%
group_by(drv) %>%
summarise(mean_cty = mean(cty, na.rm=T))
mpg %>%
group_by(drv) %>%
summarise(mean_cty = mean(cty, na.rm=TRUE))
# Q
mpg <- as.data.frame(ggplot2::mpg)
mpg[c(10, 14, 58, 93), "drv"] <- "k"
mpg[c(29, 43, 129, 203), "cty"] <- c(3, 4, 39, 42)
table(mpg$drv)
mpg$drv <- ifelse(mpg$drv %in% c("4", "f", "r"), mpg$drv, NA)
boxplot(mpg$cty)$stats #9, 26
mpg$cty <-  ifelse(mpg$cty < 9 | mpg$cty > 26, NA,  mpg$cty)
boxplot(mpg$cty)
mpg %>%
group_by(drv) %>%
summarise(mean_cty = mean(cty, na.rm=TRUE))
table(mpg$drv)
mpg %>%
filter(!is.na(mpg$drv), !is.na(mpg$cty)) %>%
group_by(drv) %>%
summarise(mean_cty = mean(cty, na.rm=TRUE))
mpg %>%
filter(!is.na(mpg$drv) !is.na(mpg$cty)) %>%
group_by(drv) %>%
summarise(mean_cty = mean(cty, na.rm=TRUE))
mpg %>%
filter(!is.na(mpg$drv) !is.na(mpg$cty)) %>%
group_by(drv) %>%
summarise(mean_cty = mean(cty, na.rm=TRUE))
mpg %>%
filter(!is.na(mpg$drv) !is.na(mpg$cty)) %>%
group_by(drv) %>%
summarise(mean_cty = mean(cty, na.rm=TRUE))
mpg %>%
filter(!is.na(mpg$drv) | !is.na(mpg$cty)) %>%
group_by(drv) %>%
summarise(mean_cty = mean(cty, na.rm=TRUE))
mpg %>%
filter(!is.na(mpg$drv) | !is.na(mpg$cty)) %>%
group_by(drv) %>%
summarise(mean_cty = mean(cty, na.rm=TRUE))
mpg %>%
filter(!is.na(drv) | !is.na(cty)) %>%
group_by(drv) %>%
summarise(mean_cty = mean(cty, na.rm=TRUE))
mpg %>%
filter( !is.na(drv) & !is.na(cty)) %>%
group_by(drv) %>%
summarise(mean_cty = mean(cty, na.rm=TRUE))
source("~/Documents/data_science_R/code/1_glance_at_R.R")
install.packages("foreign")
library(foreign)
library(dplyr)
library(ggplot2)
head(raw_welfare)
raw_welfare <- read.spss("source/Data/data_spss_Koweps2014.sav", to.data.frame = T)
head(raw_welfare)
head(raw_welfare, 5)
welfare <-raw_welfare
# glance
dim(welfare)
str(welfare)
head(welfare)
sumary(welfare)
summary(welfare)
welfare <- rename(welfare,
sex=h0901_4,
birth=h0901_5,
income=h09_din)
welfare
# Preprocessing
class(welfare$sex)
summary(welfare$sex)
table(welfare$sex)
table(!is.na(welfare$sex))
welfare <- ifelse(welfare$sex == 1, "male", "female")
table(welfare$sex)
welfare
welfare <-raw_welfare
welfare$sex <- ifelse(welfare$sex == 1, "male", "female")
table(welfare$sex)
welfare$sex <- ifelse(welfare$sex == 1, "male", "female")
welfare$sex
welfare <-raw_welfare
welfare <- rename(welfare,
sex=h0901_4,
birth=h0901_5,
income=h09_din)
welfare$sex <- ifelse(welfare$sex == 1, "male", "female")
table(welfare$sex)
qplot(welfare$sex)
# income
class(welfare$income)
summary(welfare$income)
boxplot(welfare$income)
qplot(welfare$income)
qplot(welfare$income) + xlim(0, 10000)
table(!is.na(welfare$income))
# Analysis
sex_income %>% welfare %>%
group_by(sex) %>%
summarise(mean_income = mean(income))
# Analysis
sex_income <- welfare %>%
group_by(sex) %>%
summarise(mean_income = mean(income))
sex_income
qplot(sex_income)
ggplot(data=sex_income, aes(x=sex, y=mean_income)) + geom_bar()
ggplot(data=sex_income, aes(x=sex, y=mean_income)) + geom_col()
# 2. Age & Income
class(welfare$bith)
# 2. Age & Income
class(welfare$birth)
summary(welfare$birth)
qplot(welfare$birth)
table(is.na(welfare$age))
table(!is.na(welfare$age))
table(!is.na(welfare$birth))
welfare$age <- 2014 - welfare$birth + 1
summary(welfare$age)
qplot(welfare$age)
# 2. Age & Income
age_income %>%  welfare %>%
group_by(age) %>%
summarise(mean_income = mean(income))
# 2. Age & Income
age_income <-   welfare %>%
group_by(age) %>%
summarise(mean_income = mean(income))
age_income
qplot(age_income)
ggplot(data=age_income, aes(x=age, y=age_income)) + geom_point()
age_income
ggplot(data=age_income, aes(x=age, y=mean_income) + geom_point()
ggplot(data=age_income, aes(x=age, y=mean_income) + geom_point()
ggplot(data=age_income, aes(x=age, y=mean_income)) + geom_point()
# 2. Age & Income
age_income <-   welfare %>%
group_by(age) %>%
summarise(mean_income = mean(income))
ggplot(data=age_income, aes(x=age, y=mean_income)) + geom_point()
age_income
welfare <- welfare %>%
mutate(ageg = ifelse(welfare$age <30, "초년", ifelse(welfare$age <=59, "중년", 노년))) %>%
group_by(ageg) %>%
summarise(mean_income = mean(income))
welfare <- welfare %>%
mutate(ageg = ifelse(welfare$age <30, "초년", ifelse(welfare$age <=59, "중년", "노년"))) %>%
group_by(ageg) %>%
summarise(mean_income = mean(income))
welfare
welfare <-raw_welfare
welfare <- rename(welfare,
sex=h0901_4,
birth=h0901_5,
income=h09_din)
welfare$sex <- ifelse(welfare$sex == 1, "male", "female")
welfare$age <- 2014 - welfare$birth + 1
welfare$ageg <- welfare %>%
mutate(ageg = ifelse(welfare$age <30, "young", ifelse(welfare$age <=59, "middle", "old"))) %>%
group_by(ageg) %>%
summarise(mean_income = mean(income))
welfare
welfare %>%
mutate(ageg = ifelse(welfare$age <30, "young", ifelse(welfare$age <=59, "middle", "old"))) %>%
group_by(ageg) %>%
summarise(mean_income = mean(income))
welfare$ageg <- welfare %>%
mutate(ageg = ifelse(welfare$age <30, "young", ifelse(welfare$age <=59, "middle", "old"))) %>%
welfare
welfare$ageg <- welfare %>%
mutate(ageg = ifelse(welfare$age <30, "young", ifelse(welfare$age <=59, "middle", "old"))) %>%
welfare
welfare$ageg <- welfare %>%
mutate(ageg = ifelse(welfare$age <30, "young", ifelse(welfare$age <=59, "middle", "old"))) %>%
welfare
welfare <-raw_welfare
welfare <- rename(welfare,
sex=h0901_4,
birth=h0901_5,
income=h09_din)
welfare$sex <- ifelse(welfare$sex == 1, "male", "female")
welfare$age <- 2014 - welfare$birth + 1
welfare$ageg <- welfare %>%
mutate(ageg = ifelse(welfare$age <30, "young", ifelse(welfare$age <=59, "middle", "old"))) %>%
welfare
welfare$ageg <- welfare %>%
mutate(ageg = ifelse(welfare$age <30, "young", ifelse(welfare$age <=59, "middle", "old"))) %>%
welfare
welfare <-raw_welfare
welfare <- rename(welfare,
sex=h0901_4,
birth=h0901_5,
income=h09_din)
welfare$sex <- ifelse(welfare$sex == 1, "male", "female")
welfare$age <- 2014 - welfare$birth + 1
str(welfare)
welfare$ageg <- welfare %>%
mutate(ageg = ifelse(welfare$age <30, "young", ifelse(welfare$age <=59, "middle", "old")))
welfare
table(welfare$ageg)
table(welfare$ageg)
welfare
welfare %>%
mutate(ageg = ifelse(welfare$age <30, "young", ifelse(welfare$age <=59, "middle", "old")))
welfare %>%
mutate(ageg = ifelse(welfare$age <30, "young", ifelse(welfare$age <=59, "middle", "old")))
welfare %>%
mutate(ageg = ifelse(welfare$age <30, "young", ifelse(welfare$age <=59, "middle", "old")))
welfare %>%
mutate(ageg = ifelse(welfare$age <30, "young", ifelse(welfare$age <=59, "middle", "old")))
welfare <-raw_welfare
welfare <- rename(welfare,
sex=h0901_4,
birth=h0901_5,
income=h09_din)
e
welfare$age <- 2014 - welfare$birth + 1
# 2. Age & Income
age_income <-   welfare %>%
group_by(age) %>%
summarise(mean_income = mean(income))
ggplot(data=age_income, aes(x=age, y=mean_income)) + geom_point()
welfare %>%
mutate(ageg = ifelse(welfare$age <30, "young", ifelse(welfare$age <=59, "middle", "old")))
welfare %>%
mutate(ageg = ifelse(age <30, "young", ifelse(age <=59, "middle", "old")))
welfare %>%
mutate(ageg = ifelse(age <30, "young", ifelse(age <=59, "middle", "old")))
welfare$age
welfare %>%
mutate(ageg = ifelse(age <30, "young", ifelse(age <=59, "middle", "old")))
welfare <- welfare %>%
mutate(ageg = ifelse(age <30, "young", ifelse(age <=59, "middle", "old")))
welfare$age
welfare$ageg
table(welfare$ageg)
qplot(welfare$ageg)
welfare_income <- welfare %>%
filter(ageg != "young") %>%
group_by(ageg) %>%
summarise(mean_income = mean(income))
welfare_income
qplot(welfare_income)
ggplot(data=welfare_income, aes(x=ageg, y=mean_income)) + geom_bar()
ggplot(data=welfare_income, aes(x=ageg, y=mean_income)) + geom_cil()
ggplot(data=welfare_income, aes(x=ageg, y=mean_income)) + geom_col()
# 연령대 및 성별에 따른 소득
welfare %>%
group_by(ageg, sex) %>%
summarise(mean_income = mean(income))
# 연령대 및 성별에 따른 소득
welfare %>%
filter(ageg != "young") %>%
group_by(ageg, sex) %>%
summarise(mean_income = mean(income))
# 연령대 및 성별에 따른 소득
sex_income <-  welfare %>%
filter(ageg != "young") %>%
group_by(ageg, sex) %>%
summarise(mean_income = mean(income))
# 연령대 및 성별에 따른 소득
sex_income <- welfare %>%
filter(ageg != "young") %>%
group_by(ageg, sex) %>%
summarise(mean_income = mean(income))
sex_income
ggplot(data=sex_income, aex(x=ageg, y=mean_income, filee=sex)) + geom_col()
ggplot(data=sex_income, aes(x=ageg, y=mean_income, filee=sex)) + geom_col()
ggplot(data=sex_income, aes(x=ageg, y=mean_income, fill=sex)) + geom_col()
sex_income$sex
sex_income$sex <-  ifelse(sex_income$sex == 1, "male", "female")
ggplot(data=sex_income, aes(x=ageg, y=mean_income, fill=sex)) + geom_col()
ggplot(data=sex_income, aes(x=ageg, y=mean_income, fill=sex)) + geom_col(position="dodge")
# 두 집단 평균 차이 검정.
read.csv(file="htest01.csv", header=TRUE)
# 두 집단 평균 차이 검정.
read.csv(file="source/Data/htest01.csv", header=TRUE)
# 두 집단 평균 차이 검정.
rawN3 <-read.csv(file="source/Data/htest01.csv", header=TRUE)
groupB <- rawN3[rawN3$group=='B', 1:2]
groupA
groupA <- rawN3[rawN3$group=='A', 1:2]
groupB <- rawN3[rawN3$group=='B', 1:2]
groupA
groupB
mean(groupA[, 2])
mean(groupB[, 2])
# Phase 2
# Testing Normality
shapiro.test(groupA[,2])
qqnorm(groupA[, 2])
qqline(groupA[, 2])
qqnorm(groupA[, 2])
qqnorm(groupA[, 2])
qqline(groupA[, 2])
shapiro.test(groupB[,2])
qqline(groupB[, 2])
qqnorm(groupA[, 2])
qqline(groupB[, 2])
shapiro.test(groupB[,2])
qqnorm(groupB[, 2])
qqline(groupB[, 2])
# Phase 3
# Variance Test
# Decide whether Variance Of A and B is same.
var.test(groupA[,2], groupB[, 2])
# t.test
t.test(groupA[, 2], groupB[, 2], alternative = "less", var.equal = TRUE)
##################
#Each Group has 10 samples
##################
rawN10 <-read.csv(file="source/Data/htest02.csv", header=TRUE)
groupB2 <- rawN3[rawN10$group=='B', 1:2]
groupA2 <- rawN3[rawN10$group=='A', 1:2]
mean(groupA2[,2])
mean(groupB2[,2])
groupA2 <- rawN3[rawN10$group=='A', 1:2]
groupB2 <- rawN3[rawN10$group=='B', 1:2]
group2
groupA2
##################
#Each Group has 10 samples
##################
rawN10 <-read.csv(file="source/Data/htest02.csv", header=TRUE)
rawN10
groupA2 <- rawN3[rawN10$group=='A', 1:2]
##################
#Each Group has 10 samples
##################
rawN10 <-read.csv(file="source/Data/htest02.csv", header=TRUE)
groupA2 <- rawN10[rawN10$group=='A', 1:2]
groupB2 <- rawN10[rawN10$group=='B', 1:2]
mean(groupA2[,2])
mean(groupB2[,2])
# Phase 2
# Testing Normality
shapiro.test(groupA2[,2])
qqnorm(groupA2[, 2])
qqline(groupA2[, 2])
shapiro.test(groupB2[,2])
qqnorm(groupB2[, 2])
qqline(groupB2[, 2])
# Phase 3
# Variance Test
# Decide whether Variance Of A and B is same.
var.test(groupA2[,2], groupB2[, 2])
# Phase 3
# Variance Test
# Decide whether Variance Of A and B is same.
var.test(groupA2[,2], groupB2[, 2])
# Phase 4
# t.test
t.test(groupA[, 2], groupB[, 2], alternative = "less", var.equal = FALSE)
# Phase 4
# t.test
t.test(groupA[, 2], groupB[, 2], alternative = "less", var.equal = FALSE)
# Phase 4
# t.test
t.test(groupA[, 2], groupB[, 2], alternative = "less", var.equal = FALSE)
